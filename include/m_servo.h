
/*******************************************************************************************
  @ 濠电姷鏁告慨鐑藉极閸涘﹥鍙忓ù鍏兼綑閸ㄥ倻鎲搁悧鍫濈瑲闁稿﹤鐖奸弻娑㈩敃閻樻彃濮庨梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍銈夋⒑閸濄儱孝婵☆偅绻堝濠氬Ω閳轰胶鐫勯梺鎼炲労閻撳牆螞閸曨厾纾藉ù锝嚽归。鎶芥煕鐎ｎ剙鏋涙鐐差槸椤垹鐣濋埀顒勬偪閳ь剙鈹戦悙鏉戠仸妞ゎ厼娲棟妞ゆ洍鍋撴慨濠呮閹瑰嫰濡搁妷锔惧綒闂備胶鎳撻崵鏍箯閿燂拷  Mr_Wang_Tju
闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掆偓绾惧鏌熼柇锕€骞樺ù鐘冲哺濮婄粯鎷呯粵瀣缂備胶绮崹鍧楀箠濠靛洢鍋呴柛鎰╁妿閸樻挳姊洪崨濠傚Е闁哥姵鐗犻幃鐐哄垂椤愮姳绨婚梺鐟版惈濡绂嶆ィ鍐┾拻闁搞儜灞锯枅闂佸搫琚崝宀勫煘閹达箑骞㈡繛鍡楁禋閺夊摜绱撴担楦挎闁告ê銈搁幃銉︾附缁嬭儻鎽曢梺鏂ユ櫅閸燁垱鍒婇幘顔解拻闁割偆鍠撻埢鎾绘煕鐎ｎ偅灏柍瑙勫灴瀹曞崬鈻庨幇顓у晭濠电姷鏁搁崑娑樜涘▎鎾崇濠电姵鑹鹃崥鍦偓骞垮劚椤︿即鎮¤箛鎿冪唵闁煎摜鏁稿ú瀛樹繆缂併垹鏋熼柕鍥у瀵剛鎹勯妸鎰屽洦鐓涚€光偓閳ь剟宕伴弽顓炵畺闁斥晛鍟崕鐔兼煥濠靛棙顥為柛鐘崇墵濮婄粯鎷呴崫銉ㄩ梺閫炲苯澧紒瀣尵缁綁寮埀顒勫Φ閸曨垰顫呴柍銉ュ暱閹界敻姊虹化鏇熸珨缂佺粯绻傞悾鐑藉Ω閳哄﹥鏅ｉ梺缁樺姇瀵墎浜哥€ｎ喗鈷掗柛灞剧懄缁佺増绻涙径瀣鐎规洘濞婇弫鍐磼濮橀硸鍞甸梻浣芥硶閸ｏ箓骞忛敓锟�
濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姵婢樿灃闁挎繂鎳庨弳娆戠棯閹勫仴闁哄本娲熷畷鐓庘攽閹邦厜锕傛⒑閽樺鏆熼柛鐘崇墵瀵鏁愭径濠冾棟闂佸湱枪鐎涒晠宕伴幇鐗堚拺闁煎鍊曢弸搴ｇ磽瀹ュ拑韬鐐插暢閵囨劙骞掗幋鐘垫殺闂備礁婀遍崕銈夊垂閻㈢硶鈧牗寰勯幇顓涙嫼闂佸憡绻傜€氼參藟濠婂懐纾肩紓浣癸公閼拌法鈧鍠栭…鐑藉箖閵忋倖鍋傞幖杈剧秮閻涙捇姊绘担鐑樺殌闁宦板妿閹广垽宕樿閺勫倹绻濋悽闈浶ラ柡浣告啞閹便劑顢橀姀鐘碉紱闂佸湱鍋撻悾顏呯濠婂牏鍙撻柛銉ｅ妽鐏忎即鏌涢敐鍕煓闁哄苯绉剁槐鎺懳熼悜鈺傚闂備線鈧偛鑻晶顔剧磼閻樿尙效鐎规洘娲熷畷锟犳倶缂佹ɑ銇濆┑鈩冩倐閸┾剝鎷呯憴鍕戞岸姊绘担鐟邦嚋缂佸鍨归埀顒佸嚬閸犳碍绔熼弴銏″殐闁宠鍎虫禍楣冩煕韫囨搩妲稿ù婊堢畺濮婃椽宕ㄦ繝鍌氼潎闂佸憡鏌ㄩ柊锝呯暦閵忋値鏁冮柍鍨涙櫆閺傗偓闂備胶绮敃鈺呭磻閸曨剛顩查柣鎰靛墰缁犻箖鎮楅悽鐧诲湱鏁崼鏇熺厽閹烘娊宕濋幋婵堟殾闁汇垻顣介崑鎾绘晲鎼粹剝鐏嶉梺缁樻尰濞叉﹢濡甸崟顖ｆ晣闁绘棃顥撴禒瀛樼箾鐎涙鐭嬬紒璇插濡叉劙骞掑Δ鈧儫闂佹寧娲嶉崑鎾绘煕濠靛牆鍔嬮柟渚垮妽缁绘繈宕橀埞澶歌檸婵＄偑鍊戦崹鍝劽洪悢鐓庢瀬闁圭増婢橀悙濠囨煃鏉炴壆顦︾紓宥呮缁绘繈鎮介棃娑樺缂備浇灏Λ鍕弲闂侀潧鐗嗛ˇ浼村疾濠靛洢浜滈煫鍥ㄦ尭椤忣偊鏌￠崱顓犵暤婵﹣绮欏畷鍫曞煛閸愌呯憹婵犵數鍋為崹鍫曟晝閳轰緡鐒介柍鍝勬噺閻撶喖鏌熼幆褍鏆辨い鎺嬪灲閺岋繝宕遍幇顒€濮﹀┑顔硷功缁垶骞忛崨顖滈┏閻庯綆浜濋悾浼存⒒娴ｈ鍋犻柛鏂款儔瀹曪繝骞庨悾灞界ウ婵犵數濮撮崯顖炲磿閻斿吋鐓忓┑鐐茬仢閸斻倝鏌ｅ☉鏍у姦闁哄矉缍€缁犳盯寮撮悙鎵崟濠电姭鎷冮崒婊呯厯闂佺硶鏂傞崹钘夘嚕椤曗偓瀹曞ジ鎮㈢亸浣镐壕闁汇垹鎲￠悡銉︾節闂堟稒顥滈柍褜鍓涢幊鎾诲煝瀹ュ宸濋悗娑欘焽閸樻捇鏌ｉ悩鍙夌┛閻忓繑鐟х划缁樼節濮橆厾鍘搁悗鍏夊亾閻庯綆鍓涜ⅵ闂備胶纭堕弬渚€宕戦幘鎰佹富闁靛牆妫楅崸濠囨煕鐎ｎ偅灏柍瑙勫灴椤㈡瑩鎮锋０浣割棜濠电姷顣槐鏇㈠磻閹达箑纾归柡宥庣亹閸濆嫀鐔兼惞鐟欏嫭鐣烽梻浣哥秺濡法绮堟担铏逛笉闁绘ê纾弧鈧繝鐢靛Т閸婄粯鏅堕弴銏＄厱闁靛ǹ鍎遍埀顒€缍婃俊鐢稿礋椤栨氨鐤€闂佸憡鎸烽悞锕傚磻瑜斿鍝勑ч崶褍顬堝銈庡幖閸㈡煡锝炶箛鎾佹椽顢旈崪浣诡棃婵犵數鍋為崹鍫曟偡椤栨娑樷槈閵忊檧鎷洪梺缁樻尭濞寸兘寮搁崘顔界厱闁冲搫鍊绘晶杈╃磼椤旇娅婇柟顔哄灲閹剝鎯旈敐搴℃暯闂傚倷绀侀幖顐﹀磹閸涘﹥娅犲ù鐘差儏缁€鍫ユ煏婵炵偓娅嗛柍閿嬪灩缁辨帡顢涘☉娆戭槬婵犫拃鍕弨闁哄被鍊涢妵鎰板箳閺冨倹姣囬梻浣筋嚃閸ｎ垳鎹㈠┑瀣祦闁搞儺鍓氶崑瀣煕椤愮姴鐏╂鐐村姍濮婄粯鎷呯粙娆炬闂佺ǹ顑嗛幐鎯ь嚗婵犲啨鍋呴柛鎰╁壆閵夆晜鐓曢柟鎵虫櫅婵＄兘鏌￠埀顒佺鐎ｎ偆鍘介梺褰掑亰閸撴瑧鐥閺屾盯鎮╃粵纭呪偓鍧楁煛瀹€鈧崰鏍€佸▎鎾村殥闁靛牆娲ㄩ崢顖氣攽閻樻鏆柛鎾寸箞楠炲啴宕掑☉妤冪畾闂佺粯鍨煎Λ鍕暜闂備焦瀵у濠氬磻閹捐鏋€闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜滃ù鏍煏婵炵偓娅嗛柛濠傛健閺屻劑寮村Δ鈧禍鎯ь渻閵堝骸骞栭柣蹇旂箞閿濈偛饪伴崼婵堝姦濡炪倖甯掔€氼剛绮诲鑸电厱闁规壋鏅涙俊鐑芥煛閳ь剚绂掔€ｎ偆鍘卞銈嗗姂閸婃洟寮告惔銊︾厸闁告侗鍠栭埢鏇熸叏婵犲啯銇濈€规洏鍔嶇换婵囨媴閾忓湱鐣抽梻鍌欑閹诧繝骞愰懡銈嗗床闁告洦鍘奸崹婵嬫煕椤愮喐鍣伴柛瀣崌閺佹劖鎯旈埄鍐邯缂傚倷鑳舵慨瀵哥礊婵犲偆鍤曢柛顐ｆ礀闁卞洭鏌曡箛鏇炐″瑙勬礋閺岋絾鎯旈姀銏犳殹闂佺懓鍤栭幏锟�
*******************************************************************************************/

#ifndef M_SERVO_H
#define M_SERVO_H
#include "HardwareSerial.h"
#include <Arduino.h>
class m_servo
{
public:
     m_servo(byte choose); //闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇㈡晜缂佹ɑ娅堥梻浣告啞娓氭宕归鍫濈；闁圭偓鍓氬鈺傘亜閹扳晛鐏╃紒渚囧櫍濮婅櫣鍖栭弴鐔告緬闂佺ǹ顑嗛幐鎼佲€旈崘顔嘉ч柛鈩冾殘閻熴劑姊虹粙鍖″姛閺嬵亪鏌ｉ埥鍡楀籍婵﹦绮幏鍛喆閸曨偂鍝楅梻浣呵归敃銉ф崲閸愵亞鐭夌€广儱娲﹀畷澶娿€掑鐓庣仩婵炲牄鍔岄—鍐Χ閸℃衼闂傚倸瀚€氭澘顕ｉ弻銉ョ濞达絽婀遍崣鍡涙⒑缂佹ɑ绀€闁稿﹤婀遍埀顒佺啲閹凤拷
     void senddata(char kk);
     void set_angle(int id_num, float angle, int step);
     void set_angles(int id_list[20], float angle_list[20], int step, int n);
     void change_mode(int id_num, int mode_num);
     void set_id(int id_num, int id_new);
     void set_pid(int id_num, int pid);
     float get_state(int id_num, int para_num, int o_m);
     void set_speed(int id_num, int speed);
     void set_torque(int id_num, float torque);
     void write_e2(int id_num, int address, int value);
     int read_e2(int id_num, int address);
     void read_e2_all(int id_num);
     void unlock_stall(int id_num);
     void e2_init(int id_num);
     void temprature_set(int id_num, int temprature);
     void preset_angle(int id_num, float angle, int step, int rn);
     struct MotorParameter
     {
          float cur_angle = 0; //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹烘垵顏柛濠勬暬閺屾盯鏁傜拠鎻掔婵炲濮炬ご鍛婄┍婵犲嫮纾奸柕蹇曞Х娴狀垶姊洪悷鏉跨骇闁瑰憡濞婇悰顕€骞掑Δ鈧粻锝嗙節閸偄濮囬柡渚婃嫹
          float exp_angle;     //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊风粈渚€骞栭锔藉亱闊洦绋戠粣妤呮煙闁箑澧鹃柤鐗堝缁绘繃绻濋崒娑樻闂佸摜濮村Λ婵嬪蓟閻斿吋鍊绘俊顖濇娴犳潙顪冮妶鍡橆棖闁瑰嚖鎷�
          int servo_rdata[16];
          float servo_rpara[9]; //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜滈崘鈧銈嗘尵閸嬬喖鎮￠幋锔解拺缂佸瀵у﹢鎵磼鐎ｎ偄绗掗柍缁樻崌瀹曞ジ寮撮悢鍝勫箰濠电偠鎻徊鍧楀箠閹惧嚢澶屸偓锝庡墰绾惧吋銇勯弴鐐搭棡閻庢熬鎷�
          int servo_mode;         //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹烘垵鈧敻宕戦幘鑸靛枂闁告洦鍓欐禒鈺呮⒑缁嬪灝顒㈠鐟版濡叉劙鎮欓崫鍕棟闁荤姴娲ゆ晶浠嬪窗閺嶎厼鍨傞柟顖嗗懏娈鹃梺鎼炲劗閺呪晠寮ㄩ敓锟�
          float cur_Voltage;     //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹烘垵鈧綊宕伴幇鐗堢厽婵°倐鍋撻柣妤€锕︽禍鎼侇敇閻戝棛鍞甸悷婊冪箲缁绘盯鍩€椤掑嫭鐓欐い鏃囧吹閻瑦淇婇銏犳殭闁宠棄顦灒缁炬澘褰夌槐锟�
          float cur_current;     //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹烘垵鈧綊宕伴幇鐗堢厽婵°倐鍋撻柣妤€锕︽禍鎼侇敇閻戝棛鍞甸悷婊冪箲缁绘盯鍩€椤掑嫭鐓欐い鏃囧吹閻瑧鈧娲栫紞濠囥€侀弴銏犖ч柛鎰╁妺閸狅拷
          long baud_rate;         //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹哄秷鍏岀紒鐘冲劤椤法鎹勯搹鐟邦暫闂佽娴氶崰鏍€︾捄銊﹀枂闁告洦鍋呯拠鐐烘⒑鐠団€虫灍濠电偛锕顐﹀箻缂佹ɑ娅㈤梺璺ㄥ櫐閹凤拷
          float cur_temprature;  //闂傚倷绀侀幖顐λ囬锕€鐤炬繝濠傜墕閽冪喖鏌曟繛鍨壄婵炲樊浜濋弲鎼佹煥閻曞倹瀚� 闂傚倸鍊峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厴闁告劦鍠栭悞鍨亜閹烘垵鈧綊宕伴幇鐗堢厽婵°倐鍋撻柣妤€锕︽禍鎼侇敇閻戝棛鍞甸悷婊冪箲閹便劑骞橀鍢夈儵鏌熼悜姗嗘當闁绘挻绋戦湁闁挎繂鎳庨ˉ蹇涙煕閻戝洦瀚�
     } Para; 
private:
     byte choose;                                                            //闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌ㄩ悢鍝勑㈢痪鎯ь煼閺屾盯寮撮妸銉р偓顒勬煕閵夘喖澧紒鐘劜閵囧嫰寮崒娑樻畬婵炲瓨绮庨崑鎾诲箞閵娾晜鏅查柛銈堟缂嶅﹪骞冩导瀛樺剬闁活剛鏁筺o濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姳鍗抽弻锟犲礋椤愩倗鐤勬繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闂傚牊绋戠粻鍙夌箾鐎涙鐭婄紓宥咃躬瀵濡搁埡鍌氫簽闂佺ǹ鏈粙鎴︻敂閿燂拷
     int servo_sdata[10] = {0x7b, 0x79, 0, 0, 0, 0, 0x10, 0x10, 0x10, 0x7d}; //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫晲閸涱剙顥氬┑掳鍊楁慨鐑藉磻濞戔懞鍥偨缁嬫寧鐎梺鐟板⒔缁垶宕戦幇鐗堢厱闁归偊鍨扮槐锕傛煟閵忕媭鐓兼慨濠勭帛閹峰懘鎮烽柇锕€娈濇繝鐢靛仜瀵爼鎮ч悩鑼殾闁圭増婢樼粻鐟懊归敐鍤藉綊鎮楅銏♀拺缂佸娉曢悘閬嶆煕鐎ｎ剙浠遍柟顕嗙節瀵挳鎮╅崘鍙夌€鹃梺鐟板悑閻ｎ亪宕濇繝鍥х劦妞ゆ巻鍋撻柛鐔告綑閻ｇ兘濡歌閸嬫挸鈽夊▍顓т邯閸┾偓妞ゆ巻鍋撴繛纭风節瀵鈽夐埗鈹惧亾閿曞倸绠ｆ繝闈涙噽閹稿鈹戦悙鑼憼缂侇喖绉堕崚鎺楀箻鐠囪尪鎽曢梺缁樻煥閹诧紕绱為崶顒佺厱闁圭偓顨呴幆娆撳箣閻樼數锛滅紓鍌欓檷閸ㄥ綊鐛弽顓熺厽闁哄诞浣镐划閻庢鍠涢褔鍩ユ径鎰潊闁绘ɑ鍓氬Λ鐔兼⒑閼姐倕校濞存粈绮欏畷婊勬綇椤愵偅鈻岄梻浣告惈婢跺洭鍩€椤掆偓绾绢參寮抽崱娑欏€甸柨婵嗛婢т即鏌ｉ敃鈧悧鎾诲箖濡ゅ啯鍠嗛柛鏇ㄥ墰椤︺儵鎮楃憴鍕闁告挾鍠栧畷娲閳╁啫鍔呴梺闈涚墕濞层劑寮堕幖浣光拺闁告繂瀚弳娆撴煕婵犲浂妫戦柤楦夸含閳ь剟娼ч幗婊呭娴犲鐓曢悘鐐村礃婢规﹢鏌嶈閸撴瑩宕查弻銉︾畳闂備焦鎮堕崕顖炲礉婵犲啰顩烽柛顐犲劜閻撴洘绻濋棃娑橆仼闁告梹绮撻弻锟犲幢濡偐鐓夐梺鍝勮閸旀垿骞冮姀銈呬紶闁告洘鍨崹浠嬪蓟閿涘嫧鍋撻敐鍌涙珖缂佹劖妫冮弻鈥崇暆閳ь剟宕伴弽褏鏆︽繝濠傛－濡查箖鏌ｉ姀鈺佺仭闁烩晩鍨跺濠氭晸閻樻彃绐涘銈嗘濡嫰鍩€椤掍礁濮嶉柡宀嬬磿娴狅妇鎷犻幓鎺濇綆闂備浇顕栭崰鎾诲磹濠靛棛鏆﹂柟鐑樺灍濡插牊鎱ㄥΔ鈧Λ鏃傛閿燂拷  10bit
     int servo_sdata1[4] = {0x7E, 0, 0, 0};
     int i, id_num, step, rn, n, rem_step, id_number, address, value, id_new;
     float angle;
     int flag_serial = 0;
     String data;
     int u_numm;
     
};

#endif
